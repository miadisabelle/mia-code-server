# Prompt Decomposition

## Directions

- üåÖ **EAST** ‚Äî VISION: What is being asked?
- üî• **SOUTH** ‚Äî ANALYSIS: What needs to be learned?
- üåä **WEST** ‚Äî VALIDATION: What needs reflection?
- ‚ùÑÔ∏è **NORTH** ‚Äî ACTION: What executes the cycle?

## Original Prompt

> ## Context: Cross-Repo Orchestration ‚Äî smcraft ‚Üî mia-code-server Convergence
> 
> Two agents are working simultaneously:
> - Agent A (at /b/trading/smcraft): Building smcraft RISE rispecs (70-74), implementing MMOT, wiring MCP codegen, parser validation, web‚Üíbackend bridge
> - Agent B (at /workspace/repos/miadisabelle/mia-code-server ‚Äî THIS agent): Preparing the platform to receive smcraft integration
> 
> ### Coordination deliverables:
> 1. Edit Agent A's PDE markdown
> 2. Design the creative-process-as-state-machine SMDF
> 3. Establish the submodule relationship
> 4. Create a shared vocabulary document

## Primary Intent

**Action:** orchestrate
**Target:** cross-repo convergence between smcraft and mia-code-server ‚Äî PDE edits, SMDF design, submodule setup, shared vocabulary
**Urgency:** session
**Confidence:** 92%

## Secondary Intents

1. **edit** ‚Äî /b/trading/.pde/1799837b-4411-4a0f-94c6-c99b58cf8bf4.md ‚Äî add mia-code-server coordination notes under KINSHIP upgrades and Action Stack _(explicit)_
   - depends on: create mia-code-server rispecs
2. **create** ‚Äî creative-process.smdf.json ‚Äî hierarchical state machine for Germination‚ÜíAssimilation‚ÜíCompletion with composite sub-states and events _(explicit)_
3. **evaluate** ‚Äî git submodule placement ‚Äî ./smcraft/ or ./lib/smcraft/ ‚Äî considering TypeScript package consumption and web designer embedding _(explicit)_
4. **create** ‚Äî shared vocabulary document mapping smcraft concepts (State, Transition, Event, Guard, Action) to mia-code-server concepts (WorkspacePhase, PhaseTransition, NarrativeEvent, Condition, WorkflowStep) _(explicit)_
   - depends on: create mia-code-server rispecs
5. **design** ‚Äî SMDF composite state hierarchy ‚Äî Germination{task, spec, pde-decomposition}, Assimilation{plan, code, iterate}, Completion{validate, review, integrate} with events: user_edit, ai_generate, phase_advance, tension_resolve, workspace_fork _(explicit)_
6. **ensure** ‚Äî smcraft rispecs 70-74 reference mia-code-server spec cross-links _(implicit)_
   - depends on: edit Agent A PDE
7. **validate** ‚Äî that the SMDF example file is valid per smcraft's parser and SMDF schema _(implicit)_
   - depends on: create SMDF

## Context Requirements

### Files Needed
- /b/trading/.pde/1799837b-4411-4a0f-94c6-c99b58cf8bf4.md
- /b/trading/smcraft/KINSHIP.md
- /b/trading/smcraft/py/smcraft/model.py
- /b/trading/smcraft/ts/src/model.ts
- rispecs/codevops-platform/07-workspace-lifecycle.spec.md
- rispecs/codevops-platform/02-workflow-engine.spec.md
- rispecs/mia-server-core/09-mcp-server-integration.spec.md

### Tools Required
- file editor
- git
- mcp-pde
- python (for SMDF validation)

### Assumptions
- Agent A has not yet started creating rispecs 70-74, so we can influence their content
- The SMDF format supports composite states with StateDef.states[] recursion
- jgwill/smcraft repository is accessible via git for submodule addition
- The smcraft TypeScript package can be built and consumed by mia-code-server's build system
- Both agents can write to /b/trading/.pde/ ‚Äî it is a shared filesystem

## Four Directions Analysis

### üåÖ EAST ‚Äî VISION

- Vision: Two agents converging ‚Äî smcraft builds the engine, mia-code-server builds the cockpit, the SMDF example is the shared blueprint [95%]
- Vision: creative-process.smdf.json as both test case for smcraft hierarchy AND design doc for mia-code-server workspace lifecycle [92%]
- Vision: Shared vocabulary becomes the Rosetta Stone preventing concept drift between repos [88%]

### üî• SOUTH ‚Äî ANALYSIS

- Study smcraft SMDF schema to understand composite state definition format for the creative process SMDF [92%] _(implicit)_
- Analyze smcraft TypeScript package structure to determine submodule consumption strategy [80%] _(implicit)_
- Map smcraft model.py/model.ts types to understand StateDef, TransitionDef, EventDef shapes [88%] _(implicit)_

### üåä WEST ‚Äî VALIDATION

- Validate creative-process.smdf.json against smcraft parser for correctness [78%] _(implicit)_
- Review that Agent A PDE edits don't conflict with their existing work [85%] _(implicit)_
- Ensure shared vocabulary mappings are accurate ‚Äî each concept pair must be semantically equivalent [88%]

### ‚ùÑÔ∏è NORTH ‚Äî ACTION

- Create creative-process.smdf.json with hierarchical Germination/Assimilation/Completion states [95%]
- Create shared vocabulary document mapping smcraft ‚Üî mia-code-server concepts [90%]
- Edit /b/trading/.pde/1799837b-4411-4a0f-94c6-c99b58cf8bf4.md with coordination notes [90%]
- Add jgwill/smcraft as git submodule (if decided) [70%]

## Action Stack

- [ ] Study smcraft model types (model.py, model.ts) to understand SMDF schema for composite states
- [ ] Create examples/ directory in mia-code-server
- [ ] Design and create creative-process.smdf.json ‚Äî hierarchical state machine with Germination{task,spec,pde}, Assimilation{plan,code,iterate}, Completion{validate,review,integrate} (depends on: Study smcraft model)
- [ ] Create rispecs/smcraft-integration/00-shared-vocabulary.md ‚Äî concept mapping between smcraft and mia-code-server (depends on: Create rispecs directory)
- [ ] Edit /b/trading/.pde/1799837b-4411-4a0f-94c6-c99b58cf8bf4.md ‚Äî add Agent B coordination notes under KINSHIP and Action Stack (depends on: Create mia-code-server rispecs)
- [ ] Evaluate submodule placement and add jgwill/smcraft if appropriate
- [ ] Validate creative-process.smdf.json with smcraft parser if available (depends on: Create SMDF)

## Ambiguity Flags

- **"Submodule path: ./smcraft/ (top-level) vs ./lib/smcraft/ (nested) ‚Äî affects import paths and build config"**
  - Suggestion: Use ./lib/smcraft/ to keep top-level clean and signal it's a dependency, not owned code
- **"Whether Agent A has already started creating rispecs 70-74 ‚Äî if so, edits to their PDE may be stale"**
  - Suggestion: Edit the PDE markdown anyway; Agent A will see it when they wake from their own sleep phase
- **"SMDF validation ‚Äî smcraft parser may not be importable from mia-code-server context"**
  - Suggestion: Validate manually or defer to Agent A's test suite
- **"Whether creative-process.smdf.json belongs in mia-code-server or smcraft examples/"**
  - Suggestion: Put it in both ‚Äî mia-code-server as the canonical use case, smcraft as a test fixture

## Expected Outputs

### Artifacts
- rispecs/smcraft-integration/00-shared-vocabulary.md
- examples/creative-process.smdf.json

### Updates
- /b/trading/.pde/1799837b-4411-4a0f-94c6-c99b58cf8bf4.md

### Communications
- Cross-repo coordination documented in both .pde/ files
